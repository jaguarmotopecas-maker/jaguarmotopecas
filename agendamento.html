<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Agendamento</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<link rel="stylesheet" href="style.css">
</head>
<body>

<h2>Agendamento de Servi√ßo</h2>

<form id="formAgendamento">
  <input id="nome" placeholder="Nome do Cliente" required>
  <input id="telefone" placeholder="Telefone" required>
  <input id="moto" placeholder="Moto" required>
  <input id="modelo" placeholder="Modelo" required>
  <input id="ano" type="number" placeholder="Ano" required>
  <input id="data" type="date" required>
  <input id="hora" type="time" required>
  
  <select id="servico" required>
    <option value="">Selecione o servi√ßo</option>

    <!-- MOTOR -->
    <optgroup label="üîß MOTOR">
      <option>Revis√£o completa de motor</option>
      <option>Abertura e fechamento de motor</option>
      <option>Ret√≠fica de motor</option>
      <option>Troca de pist√£o e an√©is</option>
      <option>Troca de biela</option>
      <option>Troca de virabrequim</option>
      <option>Troca de comando de v√°lvulas</option>
      <option>Regulagem de v√°lvulas</option>
      <option>Troca de junta do motor</option>
      <option>Troca de retentores</option>
      <option>Troca de rolamentos internos</option>
      <option>Corre√ß√£o de vazamentos de √≥leo</option>
      <option>Limpeza interna de motor</option>
      <option>An√°lise de ru√≠dos e batidas</option>
    </optgroup>

    <!-- SISTEMA DE TRANSMISS√ÉO -->
    <optgroup label="‚öôÔ∏è SISTEMA DE TRANSMISS√ÉO">
      <option>Troca de corrente</option>
      <option>Troca de pinh√£o</option>
      <option>Troca de coroa</option>
      <option>Ajuste de corrente</option>
      <option>Kit rela√ß√£o completo</option>
      <option>Troca de embreagem</option>
      <option>Troca de discos de embreagem</option>
      <option>Troca de molas de embreagem</option>
      <option>Regulagem de embreagem</option>
      <option>Troca de cabo de embreagem</option>
    </optgroup>

    <!-- CARBURADOR -->
    <optgroup label="‚õΩ SISTEMA DE ALIMENTA√á√ÉO - CARBURADOR">
      <option>Limpeza de carburador</option>
      <option>Regulagem de carburador</option>
      <option>Troca de gicl√™s</option>
      <option>Troca de boia</option>
      <option>Troca de reparo de carburador</option>
    </optgroup>

    <!-- INJE√á√ÉO ELETR√îNICA -->
    <optgroup label="‚õΩ SISTEMA DE ALIMENTA√á√ÉO - INJE√á√ÉO ELETR√îNICA">
      <option>Diagn√≥stico por scanner</option>
      <option>Limpeza de bico injetor</option>
      <option>Reset de ECU</option>
      <option>Atualiza√ß√£o de par√¢metros</option>
      <option>Corre√ß√£o de falhas de inje√ß√£o</option>
    </optgroup>

    <!-- SISTEMA DE IGNI√á√ÉO -->
    <optgroup label="üî• SISTEMA DE IGNI√á√ÉO">
      <option>Troca de vela</option>
      <option>Troca de cachimbo de vela</option>
      <option>Troca de bobina de igni√ß√£o</option>
      <option>Troca de CDI</option>
      <option>Diagn√≥stico de falha de igni√ß√£o</option>
      <option>Ajuste de ponto de igni√ß√£o</option>
    </optgroup>

    <!-- SISTEMA EL√âTRICO -->
    <optgroup label="‚ö° SISTEMA EL√âTRICO">
      <option>Revis√£o el√©trica completa</option>
      <option>Troca de bateria</option>
      <option>Teste de carga de bateria</option>
      <option>Troca de regulador/retificador</option>
      <option>Troca de estator</option>
      <option>Troca de chicote el√©trico</option>
      <option>Reparo em chicote</option>
      <option>Troca de rel√©s</option>
      <option>Troca de fus√≠veis</option>
      <option>Instala√ß√£o de tomada USB</option>
      <option>Instala√ß√£o de alarme</option>
      <option>Instala√ß√£o de rastreador</option>
    </optgroup>

    <!-- ILUMINA√á√ÉO -->
    <optgroup label="üí° ILUMINA√á√ÉO">
      <option>Troca de l√¢mpada de farol</option>
      <option>Troca de farol completo</option>
      <option>Troca de lanterna traseira</option>
      <option>Troca de pisca</option>
      <option>Instala√ß√£o de LED</option>
      <option>Corre√ß√£o de falhas de ilumina√ß√£o</option>
    </optgroup>

    <!-- SUSPENS√ÉO -->
    <optgroup label="üõû SUSPENS√ÉO">
      <option>Revis√£o de suspens√£o dianteira</option>
      <option>Troca de retentores de bengala</option>
      <option>Troca de √≥leo da suspens√£o</option>
      <option>Revis√£o de suspens√£o traseira</option>
      <option>Troca de amortecedor</option>
      <option>Ajuste de suspens√£o</option>
    </optgroup>

    <!-- FREIOS -->
    <optgroup label="üõë FREIOS">
      <option>Troca de pastilhas de freio</option>
      <option>Troca de lonas de freio</option>
      <option>Troca de disco de freio</option>
      <option>Sangria de freio</option>
      <option>Troca de fluido de freio</option>
      <option>Revis√£o de pin√ßa</option>
      <option>Troca de cilindro mestre</option>
      <option>Ajuste de freio traseiro</option>
    </optgroup>

    <!-- RODAS E PNEUS -->
    <optgroup label="üõû RODAS E PNEUS">
      <option>Troca de pneu</option>
      <option>Balanceamento</option>
      <option>Alinhamento de roda</option>
      <option>Troca de c√¢mara de ar</option>
      <option>Reparo de roda</option>
      <option>Troca de rolamentos de roda</option>
      <option>Aperto e ajuste de raios</option>
    </optgroup>

    <!-- DIRE√á√ÉO -->
    <optgroup label="üß∞ DIRE√á√ÉO">
      <option>Revis√£o de caixa de dire√ß√£o</option>
      <option>Troca de rolamentos de dire√ß√£o</option>
      <option>Ajuste de mesa</option>
      <option>Alinhamento de guid√£o</option>
    </optgroup>

    <!-- CHASSI -->
    <optgroup label="üõ†Ô∏è CHASSI E ESTRUTURA">
      <option>Aperto geral</option>
      <option>Solda em chassi</option>
      <option>Corre√ß√£o de folgas</option>
      <option>Substitui√ß√£o de suportes</option>
      <option>Ajuste de pedaleiras</option>
      <option>Troca de cavalete</option>
    </optgroup>

    <!-- EST√âTICA -->
    <optgroup label="üßΩ EST√âTICA E CONFORTO">
      <option>Lavagem t√©cnica</option>
      <option>Polimento</option>
      <option>Ajuste de banco</option>
      <option>Troca de manoplas</option>
      <option>Troca de retrovisores</option>
      <option>Instala√ß√£o de protetores</option>
      <option>Envelopamento simples</option>
    </optgroup>

    <!-- REVIS√ïES PROGRAMADAS -->
    <optgroup label="üîç REVIS√ïES PROGRAMADAS">
      <option>Revis√£o 1.000 km</option>
      <option>Revis√£o 5.000 km</option>
      <option>Revis√£o 10.000 km</option>
      <option>Revis√£o preventiva completa</option>
      <option>Check-up geral</option>
    </optgroup>

    <!-- SERVI√áOS COMPLEMENTARES -->
    <optgroup label="üì¶ SERVI√áOS COMPLEMENTARES">
      <option>Or√ßamento t√©cnico</option>
      <option>Laudo t√©cnico</option>
      <option>Pr√©-vistoria</option>
      <option>Inspe√ß√£o para viagem</option>
      <option>Diagn√≥stico geral</option>
      <option>Atendimento emergencial</option>
    </optgroup>

  </select>

  <button type="submit" id="btnSalvar">Salvar Agendamento</button>
</form>

<br>
<button onclick="voltar()">‚¨Ö Voltar</button>

<script>
  // Configura√ß√£o Firebase
  const firebaseConfig = {
    apiKey: "AIzaSyC4T7yFe67rW7vCyTB9hARjfUOQwVCPmj0",
    authDomain: "jaguarmotopecasagenda.firebaseapp.com",
    projectId: "jaguarmotopecasagenda",
    storageBucket: "jaguarmotopecasagenda.firebasestorage.app",
    messagingSenderId: "601748187488",
    appId: "1:601748187488:web:76fc5ac3fa9ccab1c6d605"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  const form = document.getElementById("formAgendamento");
  const btnSalvar = document.getElementById("btnSalvar");

  btnSalvar.addEventListener("click", async (e) => {
    e.preventDefault();

    const nomeCliente = document.getElementById("nome").value.trim();
    const telefoneCliente = document.getElementById("telefone").value.trim();
    const moto = document.getElementById("moto").value.trim();
    const modelo = document.getElementById("modelo").value.trim();
    const ano = document.getElementById("ano").value.trim();
    const data = document.getElementById("data").value;
    const hora = document.getElementById("hora").value;
    const servico = document.getElementById("servico").value;

    if (!nomeCliente || !telefoneCliente || !moto || !modelo || !ano || !data || !hora || !servico) {
      alert("‚ùå Preencha todos os campos!");
      return;
    }

    try {
      // Salva no Firestore
      await db.collection("agendamentos").add({
        nome: nomeCliente,
        telefone: telefoneCliente,
        moto,
        modelo,
        ano,
        data,
        hora,
        servico,
        criadoEm: firebase.firestore.FieldValue.serverTimestamp()
      });

      alert("‚úÖ Agendamento salvo com sucesso!");

      // WhatsApp
      const numeroLoja = "5585921496714";
      const numeroCliente = telefoneCliente.replace(/\D/g,"");

      const msgLoja = `üìÖ *Novo agendamento*
Cliente: ${nomeCliente}
Telefone: ${telefoneCliente}
Moto: ${moto} ${modelo}
Ano: ${ano}
Servi√ßo: ${servico}
Data/Hora: ${data} ${hora}`;

      const msgCliente = `Ol√° ${nomeCliente}! Seu agendamento para ${moto} ${modelo} (${servico}) foi confirmado para ${data} √†s ${hora}. Obrigado!`;

      window.open(`https://wa.me/${numeroLoja}?text=${encodeURIComponent(msgLoja)}`, "_blank");
      window.open(`https://wa.me/55${numeroCliente}?text=${encodeURIComponent(msgCliente)}`, "_blank");

      form.reset();

    } catch (error) {
      alert("‚ùå Erro ao salvar: " + error.message);
    }
  });

  function voltar() {
    location.href = "index.html";
  }
</script>

</body>
</html>
